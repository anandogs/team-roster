<!-- New Hire Form Component -->
<div x-data="newHireForm()" class="space-y-6 p-4">
    <form @submit.prevent="submitForm" class="space-y-6">
        <!-- Band Level Selection -->
        <div class="flex flex-col space-y-2">
            <label class="text-neutral-300">Band Level</label>
            <div class="relative">
                <button 
                    type="button"
                    @click="bandOpen = !bandOpen"
                    class="w-full flex justify-between items-center px-3 py-2 border border-neutral-700 bg-neutral-800 text-white hover:bg-neutral-700 rounded-md"
                >
                    <span x-text="selectedBand ? selectedBand.name : 'Select band...'"></span>
                    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
                
                <!-- Band Dropdown -->
                <div 
                    x-show="bandOpen" 
                    @click.away="bandOpen = false"
                    class="absolute z-10 w-full mt-1 bg-neutral-800 border border-neutral-700 rounded-md shadow-lg"
                >
                    <div class="p-2">
                        <input 
                            type="text" 
                            x-model="bandSearch" 
                            placeholder="Search band..."
                            class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 text-white rounded-md"
                        >
                    </div>
                    <div class="max-h-60 overflow-auto">
                        <template x-for="band in filteredBands" :key="band.id">
                            <button 
                                type="button"
                                @click="selectBand(band)"
                                class="w-full px-3 py-2 text-left hover:bg-neutral-700 flex items-center"
                            >
                                <span x-show="selectedBand && selectedBand.id === band.id" class="mr-2">✓</span>
                                <span x-text="band.name"></span>
                            </button>
                        </template>
                    </div>
                </div>
            </div>
            <p class="text-sm text-neutral-500">Select the band level for the new hire.</p>
        </div>

        <!-- FTE Input -->
        <div class="space-y-2">
            <label class="text-neutral-300" x-text="`${month} FTE`"></label>
            <input 
                type="number" 
                x-model="fte" 
                step="0.1" 
                min="0" 
                max="1"
                class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 text-white rounded-md"
            >
            <p class="text-sm text-neutral-500" x-text="`Full-time equivalent (0 to 1.0) for ${month.toLowerCase()}`"></p>
        </div>

        <!-- Location Selection -->
        <div class="flex flex-col space-y-2">
            <label class="text-neutral-300">Location</label>
            <div class="relative">
                <button 
                    type="button"
                    @click="locationOpen = !locationOpen"
                    class="w-full flex justify-between items-center px-3 py-2 border border-neutral-700 bg-neutral-800 text-white hover:bg-neutral-700 rounded-md"
                >
                    <span x-text="location || 'Select location...'"></span>
                    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
                
                <!-- Location Dropdown -->
                <div 
                    x-show="locationOpen" 
                    @click.away="locationOpen = false"
                    class="absolute z-10 w-full mt-1 bg-neutral-800 border border-neutral-700 rounded-md shadow-lg"
                >
                    <div class="py-1">
                        <template x-for="loc in ['Onsite', 'Offshore']" :key="loc">
                            <button 
                                type="button"
                                @click="selectLocation(loc)"
                                class="w-full px-3 py-2 text-left hover:bg-neutral-700 flex items-center"
                            >
                                <span x-show="location === loc" class="mr-2">✓</span>
                                <span x-text="loc"></span>
                            </button>
                        </template>
                    </div>
                </div>
            </div>
            <p class="text-sm text-neutral-500">Select whether this employee is onsite or offshore.</p>
        </div>

        <!-- Billable Toggle -->
        <div class="flex items-center justify-between p-4 border border-neutral-700 rounded-lg">
            <div class="space-y-0.5">
                <label class="text-neutral-300">Billable</label>
                <p class="text-sm text-neutral-500">Is this employee billable to the customer?</p>
            </div>
            <button 
                type="button"
                @click="billable = !billable"
                class="relative inline-flex h-6 w-11 items-center rounded-full"
                :class="billable ? 'bg-emerald-500' : 'bg-neutral-700'"
                >
                <span 
                    class="inline-block h-4 w-4 transform rounded-full bg-white transition"
                    :class="billable ? 'translate-x-6' : 'translate-x-1'"
                ></span>
            </button>
        </div>

        <button 
            type="submit"
            class="w-full px-4 py-2 bg-neutral-100 text-black hover:bg-white rounded-md"
        >
            Add New Hire
        </button>
    </form>
</div>

<script>
function newHireForm() {
    return {
        bandOpen: false,
        locationOpen: false,
        bandSearch: '',
        selectedBand: null,
        fte: 1,
        location: 'Offshore',
        billable: true,
        month: 'April', // This should be set from your global state
        bands: [
            { id: 'band1', name: 'Junior' },
            { id: 'band2', name: 'Mid-level' },
            { id: 'band3', name: 'Senior' },
            { id: 'band4', name: 'Principal' },
        ],
        get filteredBands() {
            return this.bands.filter(band => 
                band.name.toLowerCase().includes(this.bandSearch.toLowerCase())
            );
        },
        selectBand(band) {
            this.selectedBand = band;
            this.bandOpen = false;
        },
        selectLocation(loc) {
            this.location = loc;
            this.locationOpen = false;
        },
        submitForm() {
            if (!this.selectedBand) {
                alert('Please select a band level');
                return;
            }

            const newHireId = 'newhire-' + Math.random().toString(36).substr(2, 9);
            const newEmployee = {
                id: newHireId,
                name: `New Hire (${this.selectedBand.name})`,
                band: this.selectedBand.name,
                businessUnit: 'BU A', // This should come from your global state
                customer: 'Customer A', // This should come from your global state
                fteApril: this.month === 'April' ? this.fte : 0,
                fteMay: this.month === 'May' ? this.fte : 0,
                fteJune: this.month === 'June' ? this.fte : 0,
                fteQuarter: this.month === 'Quarter' ? this.fte : 0,
                location: this.location,
                billable: this.billable
            };

            // Dispatch event to add new hire
            window.dispatchEvent(new CustomEvent('add-new-hire', { 
                detail: newEmployee 
            }));

            // Reset form
            this.selectedBand = null;
            this.fte = 1;
            this.location = 'Offshore';
            this.billable = true;
            this.bandSearch = '';
        }
    }
}
</script> 